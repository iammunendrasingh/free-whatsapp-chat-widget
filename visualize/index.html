<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualize WhatsApp Widget</title>
    <script>
        var url = '../main.js';
        var s = document.createElement('script');
            s.type = 'text/javascript';
            s.async = true;
            s.src = url;
            var options = {
            "enabled": true,
            "chatButtonSetting": {
                "backgroundColor": "#4DC247",
                "ctaText": "",
                "borderRadius": "25",
                "marginLeft": "",
                "marginBottom": "30",
                "marginRight": "30",
                "position": "right"
            },
            "brandSetting": {
                "brandName": "Munendra Singh",
                "brandSubTitle": "Typically replies within 24 hrs",
                "brandImg": "https://gravatar.com/avatar/5c77d83e3b7c63a7a1764b4ebc4b191e?size=256&cache=1726093597906",
                "welcomeText": "Hi there!\nHow can we help you?",
                "messageText": "Hello, I have a question about {{page_link}}",
                "backgroundColor": "#404145",
                "ctaText": "Start Chat",
                "borderRadius": "25",
                "autoShow": false,
                "phoneNumber": "918851730877"
            }
        };
            s.onload = function() {
                CreateWhatsappChatWidget(options);
            };
            var x = document.getElementsByTagName('script')[0];
            x.parentNode.insertBefore(s, x);
        </script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="website-form" id="top">
            <div class="title-section">
                <h3 style="text-align: center;">Visualize WhatsApp Widget on your Website</h3>
            </div>
            <div class="form-section">
                <div class="form">
                    <label for="website-url">Enter your website URL</label>
                    <input type="text" id="website-url" placeholder="https://example.com" value="https://" />
                    <details>
                        <summary>Error in loading?</summary>
                        <p>If your website has certain security settings <br>e.g. X-Frame-Options headers, it might refuse/block loading.</p>
                    </details>
                    <button onclick="loadWebsite()" class="load-btn">Load Website</button>
                </div>
                <p id="error-message" class="error"></p>
            </div>
        </div>
        <div class="bottom" id="bottom">
            <div class="fullscreen-btn-container"><button id="fullscreen-btn" class="fullscreen-btn">‚ÜïÔ∏è Full Screen ‚ÜïÔ∏è</button></div>
            <button id="promo-btn" class="promo-btn">
                üí¨ Like this? Add to your website!
            </button>
            <iframe id="website-frame" src="https://iammunendrasingh.github.io/free-whatsapp-chat-widget/" frameborder="0"></iframe>
        </div>
    </div>
    <script src="script.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Function to show typing effect with dots animation
    function showTypingEffect(element, duration) {
        let dots = 0;
        const typingInterval = setInterval(function () {
            dots = (dots + 1) % 4; // Cycles between 0, 1, 2, 3 dots
            element.innerHTML = `Typing${'.'.repeat(dots)}`;
        }, 500); // Change dots every 500ms

        // Stop after the specified duration
        setTimeout(function () {
            clearInterval(typingInterval);
        }, duration);
    }

    // Function to get the current local time in HH:MM AM/PM format
    function getCurrentLocalTime() {
        const now = new Date();
        const hours = now.getHours();
        const minutes = now.getMinutes().toString().padStart(2, '0');
        const period = hours >= 12 ? 'PM' : 'AM';
        const formattedHours = (hours % 12) || 12; // Convert to 12-hour format
        return `${formattedHours}:${minutes} ${period}`;
    }

    function getRandomDuration() {
        return Math.floor(Math.random() * (180 - 30 + 1) + 30) * 1000; // Convert seconds to milliseconds
    }

    function toggleOnlineStatus(subtitleElement) {
        const currentTime = getCurrentLocalTime();

        function setStatusToOnline() {
            if (subtitleElement) {
                subtitleElement.innerHTML = "Online";
            }

            setTimeout(setStatusToLastSeen, getRandomDuration());
        }

        function setStatusToLastSeen() {
            if (subtitleElement) {
                subtitleElement.innerHTML = `Last seen today at ${currentTime}`;
            }

            // Randomly choose a duration (30 to 180 seconds) to switch back to "Online"
            setTimeout(setStatusToOnline, getRandomDuration());
        }

        // Start with "Online"
        setStatusToOnline();
    }

    setTimeout(function () {
        const chatBox = document.querySelector('.wa-chat-box');
        if (chatBox) {
            chatBox.style.display = 'block';
        }

        //Show "Typing..." effect for 3 seconds in the subtitle
        const subtitleElement = document.querySelector('.wa-chat-box-brand-subtitle');
        if (subtitleElement) {
            showTypingEffect(subtitleElement, 3000); 
        }

        setTimeout(function () {
            const chatContainer = document.querySelector('.wa-chat-box-content');
            const originalMessage = document.querySelector('.wa-chat-box-content-chat');

            if (chatContainer && originalMessage) {
                // Clone the original chat message div
                const newMessageDiv = originalMessage.cloneNode(true);

                // Remove the brand name div in the cloned message
                const brandElement = newMessageDiv.querySelector('.wa-chat-box-content-chat-brand');
                if (brandElement) {
                    brandElement.remove();
                }

                // Update the new message text inside the cloned div
                const welcomeMessage = newMessageDiv.querySelector('.wa-chat-box-content-chat-welcome');
                if (welcomeMessage) {
                    welcomeMessage.innerHTML = `Need assistance setting up your Widget?<br>I'm here to help‚Äîfree of charge!`;
                }

                // Append the new message div to the chat container
                chatContainer.appendChild(newMessageDiv);
            }

            if (subtitleElement) {
                toggleOnlineStatus(subtitleElement); // Start toggling between Online and Last seen
            }
        }, 3000); // Change the message after the typing effect ends
    }, 3000); // 3 seconds delay before showing chat box and starting typing effect
});
</script>
</body>
</html>